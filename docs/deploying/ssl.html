<html lang="en" dir="ltr">
  <head>
			<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-73924704-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

		gtag('config', 'UA-73924704-2', { 'anonymize_ip': true });
</script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0">
    <title>Enabling SSL/TLS</title>
    <link rel="icon" type="image/png" href="../../assets/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="../../assets/favicon-16x16.png" sizes="16x16" />
    <link href=“https://fonts.googleapis.com/css?family=IBM+Plex+Sans” rel=“stylesheet”>
    <link rel="stylesheet" href="../../css/reset.css">
    <link rel="stylesheet" href="../../css/dist/docs.css">
  </head>
<body>
  <section class="docs-grid-container">
    <aside id="sidebar" class="docs-item-1 docs-sidebar">
      <h1 class="docs-title"><a href="/index.html">KITURA <span class="blue-text">DOCS</span></a></h1>
      <div class="underline-title"></div>
      <ul class="sidebar-list">
        <li class="sidebar-item collapsible">Getting Started</li>
        <ul class="nested-sidebar-list content">
          <li class="nested-sidebar-item"><a href="../getting-started/installation-mac.html">Install Swift for macOS</a></li>
          <li class="nested-sidebar-item"><a href="../getting-started/installation-linux.html">Install Swift for Linux</a></li>
          <li class="nested-sidebar-item"><a href="../getting-started/hello-world.html">Hello World</a></li>
          <li class="nested-sidebar-item"><a href="../getting-started/create-server.html">Create a server</a></li>

          <li class="nested-sidebar-item"><a href="../getting-started/update-package.html">Adding Packages</a></li>
        </ul>
        <li class="sidebar-item collapsible">Logging</li>
        <ul class="nested-sidebar-list content">
          <li class="nested-sidebar-item"><a href="../logging/logging.html">What is Logging?</a></li>
          <li class="nested-sidebar-item"><a href="../logging/helium-logger.html">Helium Logger</a></li>
        </ul>
        <li class="sidebar-item collapsible">Routing</li>
        <ul class="nested-sidebar-list content">
          <li class="nested-sidebar-item"><a href="../routing/routing.html">What is routing?</a></li>
          <li class="nested-sidebar-item"><a href="../routing/codable-routing.html">Codable routing</a></li>
          <li class="nested-sidebar-item"><a href="../routing/raw-routing.html">Raw routing</a></li>
          <li class="nested-sidebar-item"><a href="../routing/open-api.html">OpenAPI</a></li>
        </ul>
        <li class="sidebar-item collapsible">Databases</li>
        <ul class="nested-sidebar-list content">
          <li class="nested-sidebar-item"><a href="../databases/databases.html">What are Databases?</a></li>
          <li class="nested-sidebar-item"><a href="../databases/swift-kuery-orm.html">SQL: ORM</a></li>
          <li class="nested-sidebar-item"><a href="../databases/swift-kuery.html">SQL: Kuery</a></li>
          <li class="nested-sidebar-item"><a href="../databases/couchdb.html">NoSQL: CouchDB</a></li>
        </ul>
        <li class="sidebar-item collapsible">Sessions</li>
        <ul class="nested-sidebar-list content">
          <li class="nested-sidebar-item"><a href="../sessions/sessions.html">What are Sessions?</a></li>
          <li class="nested-sidebar-item"><a href="../sessions/kitura-session.html">Raw Routing Session</a></li>
          <li class="nested-sidebar-item"><a href="../sessions/type-safe-session.html">Codable Routing Session</a></li>
        </ul>
        <li class="sidebar-item collapsible">Authentication</li>
        <ul class="nested-sidebar-list content">
          <li class="nested-sidebar-item"><a href="../authentication/authentication.html">What is Authentication?</a></li>
          <li class="nested-sidebar-item"><a href="../authentication/typesafe-auth.html">Basic Authentication</a></li>
          <li class="nested-sidebar-item"><a href="../authentication/jwt-auth.html">JSON Web Tokens</a></li>
          <li class="nested-sidebar-item"><a href="../authentication/fb-google-oauth2.html">OAuth 2.0 with Facebook/Google</a></li>
        </ul>
        <li class="sidebar-item collapsible">Web Application</li>
        <ul class="nested-sidebar-list content">
          <li class="nested-sidebar-item"><a href="../templating/templating.html">What are Web Applications?</a></li>
          <li class="nested-sidebar-item"><a href="../templating/static-file-server.html">Static File Server</a></li>
          <li class="nested-sidebar-item"><a href="../templating/stencil.html">Stencil</a></li>
          <li class="nested-sidebar-item"><a href="../templating/markdown.html">Markdown</a></li>
        </ul>
        <li class="sidebar-item collapsible">WebSockets</li>
        <ul class="nested-sidebar-list content">
          <li class="nested-sidebar-item"><a href="../websockets/websockets.html">What are WebSockets?</a></li>
          <li class="nested-sidebar-item"><a href="../websockets/echo-server.html">Echo Server</a></li>
        </ul>
        <li class="sidebar-item collapsible">Deploying</li>
        <ul class="nested-sidebar-list content" style="max-height: 400px;">
          <li class="nested-sidebar-item"><a href="../deploying/monitoring.html">Monitoring</a></li>
          <li class="nested-sidebar-item active"><a href="../deploying/ssl.html">Enabling SSL/TLS</a></li>
          <li class="nested-sidebar-item"><a href="../deploying/docker.html">Docker</a></li>
          <li class="nested-sidebar-item"><a href="../deploying/kubernetes.html">Kubernetes</a></li>
          <li class="nested-sidebar-item"><a href="../deploying/cloud-foundry.html">Cloud Foundry</a></li>
        </ul>
        <li class="sidebar-item collapsible">Configuring</li>
        <ul class="nested-sidebar-list content">
          <li class="nested-sidebar-item"><a href="../configuring/enabling-nio.html">Enabling SwiftNIO</a></li>
        </ul>
      </ul>
    </aside>
    <div id="burgerIcon" class="burger-icon" onclick="showSidebar()">
      <div class="burger-line"></div>
      <div class="burger-line"></div>
      <div class="burger-line"></div>
    </div>
    <div class="docs-item-2 search-container">
    </div>
    <nav class="docs-item-3 docs-nav">
      <button id="api-button" class="apiref-button" type="button" name="button" onclick="window.open('https://ibm-swift.github.io/Kitura/')">API Reference</button>
      <a class="nav-item" target="_blank" href="http://slack.kitura.io/">Need help?</a>
      <a class="nav-item" target="_blank" href="https://github.com/IBM-Swift/kitura.io/issues">Found an issue?</a>
    </nav>
    <div id="doc-container" class="docs-item-4 docs-window">
    <main>
      <h1 class="heading-1">Enabling SSL/TLS</h1>
      <p class="block-text">Transport Layer Security (TLS) is a protocol for encrypting data that is sent over the internet. It provides three important features:</p>
      <ul>
        <li>Data Privacy: The data that is exchanged between a server and client is not visible to anyone else.</li>
        <li>Data Integrity: The data that is exchanged between a server and client cannot be modified by anyone else.</li>
        <li>Server Authenticity: The server can prove its identity to the client and so prove the origin of sent data.</li>
    </ul>
    <p class="block-text">TLS evolved out of Netscape’s Secure Sockets Layer (SSL) protocol in order to fix most of its security flaws.
         The industry still uses the terms somewhat interchangeably for historical reasons.
         Any web site that you visit starting with https:// rather than http:// is using TLS/SSL for communication between your browser and their server.</p>
    <div class="info">
      <p class="block-text">This guide will demonstrate how to enable the TLS protocol directly on your Kitura server. Another way to enable TLS is via an SSL/TLS proxy.
           In this case an intermediary application between your server and clients performs the encryption and decryption.
           Some cloud providers offer this service by default, which may be a more appropriate solution.</p>
      </div>
      <div class="underline"></div>
      <h3 class="heading-3">Install OpenSSL</h3>
      <p>In this guide, we will use OpenSSL to generate our self-signed certificate.</p>
      <p>OpenSSL is included by default on Linux. On MacOS we can install it using Homebrew:</p>
      <pre><code>brew install openssl</code></pre>
      <div class="underline"></div>
      <h2 class="heading-2"><span class="blue-text">Step 1:</span> Create our certificate and key pair</h2>
      <p class="block-text">To enable TLS, a server needs a certificate and a corresponding secret key.
           Certificates are files that bind together information about the identity of the owner of a site and the public half of an asymmetric key pair (usually RSA).
           Certificates are usually digitally signed by a certificate authority (CA) who verifies that the identity information in the certificate is correct.
           This creates a chain of certificates between the site owner certificate and a CA certificate and transitive trust.
            Assuming that we trust the CA, we can trust the validity of the server certificate.</p>
       <div class="info">
          <p class="block-text">
              If you want to create a CA-signed certificate chain,
              <a href="https://letsencrypt.org/" target="_blank">Let’s Encrypt</a> is a Certificate Authority (CA),
              provided by the non-profit Internet Security Research Group (ISRG) that makes it easy to generate and install free TLS/SSL certificates.
           </p>
       </div>
      <p>In this guide, we will use OpenSSL to generate a self-signed certificate.</p>
      <div class="info">
          <p>If you don't have a server, follow our <a target="_blank" href="https://www.kitura.io/docs/getting-started/create-server.html"> Create a server</a> guide.</p>
      </div>
      <p>Create a Credentials folder in the root of your project:</p>
      <pre><code>mkdir Credentials && cd Credentials</code></pre>
      <p>Inside this folder we create a 2048 bit RSA private key using OpenSSL:</p>
      <pre><code>openssl genrsa -out key.pem 2048</code></pre>
      <p>We use this private key to create a certificate:</p>
      <pre><code>openssl req -new -sha256 -key key.pem -out csr.csr</code></pre>
      <p class="block-text">At this stage you provide additional information that will be stored in the certificate.</p>
      <p class="block-text">These choices are optional, except for Common Name, which must be the server's hostname. In our case, this is "localhost".</p>
      <p>Next we use OpenSSL to convert the certificate to PEM format:</p>
      <pre><code>openssl req -x509 -sha256 -days 365 -key key.pem -in csr.csr -out cert.pem</code></pre>
      <p>Finally we encrypt the key and certificate together using a password. For simplicity we will use "password".</p>
      <pre><code>openssl pkcs12 -export -out cert.pfx -inkey key.pem -in cert.pem</code></pre>
<div class="underline"></div>
      <h2 class="heading-2"><span class="blue-text">Step 2:</span> Setting up your SSL configuration</h2>
      <p>Now we have created our certificate, we are going to set up our SSL configuration so that it can direct Kitura to the required files.</p>
      <p>Open your <strong>Application.swift</strong> file:</p>
      <pre><code>open Sources/Application/Application.swift</code></pre>
      <p>We are going to use <a href="https://github.com/IBM-Swift/FileKit" target="_blank">FileKit</a> to access our certificate file, so we need to <a target="_blank" href="https://github.com/IBM-Swift/FileKit#add-dependencies"> add FileKit to our dependencies</a>.</p>
      <p>We also need to add <strong>FileKit</strong> to our import statements:</p>
      <pre><code class="language-swift">import FileKit</code></pre>
      <p>Now we initialize an <strong>SSLConfig</strong> struct. On macOS we use Apple Secure Transport under the covers, which requires the path to our <strong>cert.pfx</strong> file and
           the password we used to encrypt the file. On Linux we use OpenSSL under the covers, which requires the paths to the certificate and private key PEM files.</p>
      <p>We use <strong>#if</strong> to check which operating system we're running on and provide the appropriate files to our configuration. </p>
      <p>Inside the <strong>App</strong> class, add the following code:<p>
      <pre><code class="language-swift">#if os(Linux)
let sslConfig =  SSLConfig(withCACertificateDirectory: nil,
                             usingCertificateFile: FileKit.projectFolder + "/Credentials/cert.pem",
                             withKeyFile: FileKit.projectFolder + "/Credentials/key.pem",
                             usingSelfSignedCerts: true)
#else // on macOS

let sslConfig =  SSLConfig(withChainFilePath: FileKit.projectFolder + "/Credentials/cert.pfx",
                             withPassword: "password",
                             usingSelfSignedCerts: true)

#endif</code></pre>
      <div class="underline"></div>
      <h2 class="heading-2"><span class="blue-text">Step 3:</span> Configure our Kitura server to use SSL</h2>
      <p>Now we have our SSL configuration, we need to pass it to Kitura.
      We do this as part of the <strong>addHTTPServer</strong> function, using the <strong>withSSL</strong> parameter.</p>
      <p>Inside the run function, replace:</p>
      <pre><code class="language-swift">Kitura.addHTTPServer(onPort: 8080, with: router)</code></pre>
      <p>With the following code:</p>
      <pre><code class="language-swift">Kitura.addHTTPServer(onPort: 8080, with: router, withSSL: sslConfig)</code></pre>
      <p>To test this, start your server and open your browser at the Kitura landing page:</p>
      <p><a href="https://localhost:8080" target="_blank">https://localhost:8080</a></p>
      <div class="info">
      <p class="block-text">At this point your browser might stop you with a warning that the SSL certificate it is validating is self-signed.
           Since you are accessing your own server this isn’t a problem at all. In the advanced settings, you can tell your web-browser to accept the self-signed SSL certificate and continue.
           In general though, your browser should only trust server certificates which are issued by a valid CA.</p>
        </div>
      <p class="block-text">Notice the https in your URL. You are running Kitura using SSL/TLS!
           This means that the data your application transmits is secure and the server your users are connecting to is authenticated.
    </main>
    </div>
    <div id="top-page" class="top-page">
      <a href="#">Back to top</a>
    </div>
    </section>
    <script type="text/javascript" src="../../scripts/learn.js"></script>
    <script type="text/javascript" src="../../scripts/docs.js"></script>
    <script type="text/javascript" src="../../scripts/prism.js"></script>
  </body>
</html>
