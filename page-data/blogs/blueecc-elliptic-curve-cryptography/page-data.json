{"componentChunkName":"component---src-templates-blogs-js","path":"/blogs/blueecc-elliptic-curve-cryptography","webpackCompilationHash":"a23aaa782308d970cae7","result":{"data":{"blog":{"html":"<p>We have just released BlueECC, a new Swift package for cross-platform elliptic curve cryptography. This enables you to encrypt, decrypt, sign and verify data using elliptic curve asymmetric keys. This blog post will explain what elliptic curves are, why you would use them over RSA and provides examples of the BlueECC API.</p>\n<h2 id=\"what-is-elliptic-curve-cryptography\"><a href=\"#what-is-elliptic-curve-cryptography\" aria-label=\"what is elliptic curve cryptography permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What is Elliptic Curve Cryptography?</h2>\n<p>In RSA cryptography, the security of the public/private key pair relies on the complexity of factorizing a large integer. In Elliptic Curve Cryptography, the security relies on the complexity of finding the discrete logarithm of a random elliptic curve element.</p>\n<p>BlueECC uses the Elliptic Curve Integrated Encryption Scheme (ECIES) and Elliptic Curve Digital Signature Algorithm (ECDSA) for its cryptography. Fortunately, you do not need to know the mathematics behind the algorithms to use them. They work just like RSA with a public key for encryption/verifying and a private key for decryption/signing.</p>\n<hr>\n<h2 id=\"why-use-elliptic-curve-over-rsa\"><a href=\"#why-use-elliptic-curve-over-rsa\" aria-label=\"why use elliptic curve over rsa permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why use Elliptic Curve over RSA?</h2>\n<p>Elliptic curve (EC) keys allow you to perform the same asymmetric public key cryptography as RSA keys. However, they have gained popularity due to the following advantages:</p>\n<ul>\n<li>Smaller key sizes (a 256 bit EC private key is considered equivalent to a 3072 bit RSA private key)</li>\n<li>Faster key generation</li>\n<li>Faster signing/verifying</li>\n<li>Smaller signatures (approximately 1/6th the size of an equivalent RSA signature)</li>\n<li>Smaller encryption payloads (EC adds 81 bytes per message vs 528 bytes for RSA)</li>\n</ul>\n<hr>\n<h2 id=\"blueecc-example\"><a href=\"#blueecc-example\" aria-label=\"blueecc example permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>BlueECC Example</h2>\n<p>Under the covers, BlueECC uses the Apple Security framework on macOS/iOS and OpenSSL on Linux. This means you can use it on both platforms without installing additional dependencies. BlueECC is available to import through Swift Package Manager or CocoaPods.</p>\n<h3 id=\"generating-ec-keys\"><a href=\"#generating-ec-keys\" aria-label=\"generating ec keys permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Generating EC keys</h3>\n<p>We will use the OpenSSL command line to generate our EC private and public keys.</p>\n<ol>\n<li>On macOS you can install OpenSSL using brew:</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ brew install openssl</code></pre></div>\n<ol start=\"2\">\n<li>Once you have installed OpenSSL, create your private key:</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ openssl ecparam -name prime256v1 -genkey -noout -out ec256priv.pem</code></pre></div>\n<ol start=\"3\">\n<li>Using the private key, create your public key:</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ openssl ec -in ec256priv.pem -pubout -out ec256pub.pem</code></pre></div>\n<p>This will have created two files called ec256priv.pem and ec256pub.pem. Open them in a text editor and you will see EC keys for the prime256v1 curve in PEM format. These can then be passed to BlueECC to create your keys:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">let</span> ecPubKey <span class=\"token operator\">=</span> <span class=\"token keyword\">try</span> <span class=\"token function\">ECPublicKey</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">:</span> <span class=\"token string\">\"&lt;publicPEM>\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">let</span> ecPrivKey <span class=\"token operator\">=</span> <span class=\"token keyword\">try</span> <span class=\"token function\">ECPrivateKey</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">:</span> <span class=\"token string\">\"&lt;privatePEM>\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Alternatively, you can generate the EC Keys directly using the BlueECC:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">let</span> ecPubKey <span class=\"token operator\">=</span> <span class=\"token keyword\">try</span> ecPrivKey<span class=\"token punctuation\">.</span><span class=\"token function\">extractPublicKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">print</span><span class=\"token punctuation\">(</span>ecPrivKey<span class=\"token punctuation\">.</span>pemString<span class=\"token punctuation\">)</span>\n<span class=\"token function\">print</span><span class=\"token punctuation\">(</span>ecPubKey<span class=\"token punctuation\">.</span>pemString<span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"signing-and-verifying\"><a href=\"#signing-and-verifying\" aria-label=\"signing and verifying permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Signing and Verifying</h3>\n<p>One use of asymmetric keys is in signing data. In this case, you produce a signature by signing the data with the private key. If the signature is successfully verified using the public key, you can be sure it was produced using the private key and that the data hasnâ€™t been changed. This ensures the authenticity and integrity of the data.</p>\n<p>With BlueECC you sign the plaintext as follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">let</span> signature <span class=\"token operator\">=</span> <span class=\"token keyword\">try</span> <span class=\"token string\">\"hello world\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">sign</span><span class=\"token punctuation\">(</span>with<span class=\"token punctuation\">:</span> ecPrivKey<span class=\"token punctuation\">)</span></code></pre></div>\n<p>This will take your message and use the private key to create an ECSignature. This struct can then be verified with the corresponding public key:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">let</span> verified <span class=\"token operator\">=</span> signature<span class=\"token punctuation\">.</span><span class=\"token function\">verify</span><span class=\"token punctuation\">(</span>plaintext<span class=\"token punctuation\">:</span> <span class=\"token string\">\"hello world\"</span><span class=\"token punctuation\">,</span> using<span class=\"token punctuation\">:</span> ecPubKey<span class=\"token punctuation\">)</span></code></pre></div>\n<p>To produce either true or false depending on whether the signature is valid for the provided plaintext and public key.</p>\n<h3 id=\"encrypting-and-decrypting\"><a href=\"#encrypting-and-decrypting\" aria-label=\"encrypting and decrypting permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Encrypting and Decrypting</h3>\n<p>The other use of asymmetric keys is in encryption and decryption. In this case you provide the private key to the person who you want to communicate securely with and they use it to encrypt the plaintext. The message can only be decrypted using the private key.</p>\n<p>Since asymmetric encryption can only be used on a small plaintext, BlueECC uses Elliptic Curve Integrated Encryption Scheme (ECIES). This consists of encrypting the message using AES-GCM with a symmetric key, followed by encrypting that symmetric key using Elliptic-curve Diffieâ€“Hellman (ECDH). The encrypted symmetric key and encrypted message are both sent in an envelope. The receiver of the envelope then decrypts the symmetric key and uses that to decrypt the original message.</p>\n<p>BlueECC handles this process for you, so encryption becomes:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">let</span> encrypted <span class=\"token operator\">=</span> <span class=\"token keyword\">try</span> <span class=\"token string\">\"Hello World\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">encrypt</span><span class=\"token punctuation\">(</span>with<span class=\"token punctuation\">:</span> ecPubKey<span class=\"token punctuation\">)</span></code></pre></div>\n<p>This will produce the encrypted data envelope that is structured as follows:</p>\n<ul>\n<li>Ephemeral public key (65/97/133 bytes depending on curve)</li>\n<li>Encrypted ciphertext (length of the plaintext)</li>\n<li>GCM tag (16 bytes)</li>\n</ul>\n<p>To decrypt this data, pass it to BlueECC with the private key:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">let</span> decrypted <span class=\"token operator\">=</span> <span class=\"token keyword\">try</span> encrypted<span class=\"token punctuation\">.</span><span class=\"token function\">decrypt</span><span class=\"token punctuation\">(</span>with<span class=\"token punctuation\">:</span> ecPrivKey<span class=\"token punctuation\">)</span>\n<span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">:</span> decryptedData<span class=\"token punctuation\">,</span> encoding<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>utf8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// \"Hello World\"</span></code></pre></div>\n<p>The encrypted data has been decrypted back to the original plaintext.</p>","frontmatter":{"path":"/blogs/blueecc-elliptic-curve-cryptography","title":"BlueECC: Encrypt, Decrypt, Sign and Verify with Elliptic Curve","author":"Andrew Lees","date":"2019-03-04"}}},"pageContext":{"isCreatedByStatefulCreatePages":false}}}