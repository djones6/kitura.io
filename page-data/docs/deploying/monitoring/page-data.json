{"componentChunkName":"component---src-templates-docs-js","path":"/docs/deploying/monitoring","webpackCompilationHash":"ce65eca4090760710b8f","result":{"data":{"docs":{"html":"<h1 id=\"monitor-the-status-of-your-server\"><a href=\"#monitor-the-status-of-your-server\" aria-label=\"monitor the status of your server permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Monitor the status of your Server</h1>\n<blockquote>\n<p>Depending on how you created your Kitura server you may already have metrics enabled.</p>\n</blockquote>\n<h2 id=\"what-is-application-metrics-for-swift\"><a href=\"#what-is-application-metrics-for-swift\" aria-label=\"what is application metrics for swift permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What is Application Metrics for Swift?</h2>\n<p>Application Metrics for Swift instruments the Swift runtime for performance monitoring. The monitoring data is provided back to the user either programatically via an API, or visually with the included embedded dashboard.</p>\n<p>This guide will show you how to set up the embedded dashboard to view monitoring data. It then describes how to provide a Prometheus endpoint and how to collect metrics from your Swift application using the REST API.</p>\n<p>Application Metrics for Swift provides the following built-in data collection sources:</p>\n<table>\n<thead>\n<tr>\n<th>Source</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Environment</td>\n<td>Machine and runtime environment information</td>\n</tr>\n<tr>\n<td>CPU</td>\n<td>Process and system CPU</td>\n</tr>\n<tr>\n<td>Memory</td>\n<td>Process and system memory usage</td>\n</tr>\n<tr>\n<td>HTTP</td>\n<td>HTTP metric information</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h2 id=\"step-1-add-application-metrics-for-swift-to-your-project\"><a href=\"#step-1-add-application-metrics-for-swift-to-your-project\" aria-label=\"step 1 add application metrics for swift to your project permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step 1: Add Application Metrics for Swift to your project</h2>\n<p>To use Application Metrics for Swift from your server, we need to add SwiftMetrics to our dependencies.</p>\n<blockquote>\n<p>If you don't have a server, follow our Create a server guide.</p>\n</blockquote>\n<p>Import the base Application Metrics for Swift library into your project:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">import</span> <span class=\"token builtin\">SwiftMetrics</span></code></pre></div>\n<p>Import the Application Metrics for Swift dashboard:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">import</span> <span class=\"token builtin\">SwiftMetricsDash</span></code></pre></div>\n<hr>\n<h2 id=\"step-2-initialize-application-metrics-for-swift\"><a href=\"#step-2-initialize-application-metrics-for-swift\" aria-label=\"step 2 initialize application metrics for swift permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step 2: Initialize Application Metrics for Swift</h2>\n<p>Create an instance of SwiftMetrics:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">let</span> sm <span class=\"token operator\">=</span> <span class=\"token keyword\">try</span> <span class=\"token function\">SwiftMetrics</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Use this SwiftMetrics instance to initialize the dashboard:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">let</span> smd <span class=\"token operator\">=</span> <span class=\"token keyword\">try</span> <span class=\"token function\">SwiftMetricsDash</span><span class=\"token punctuation\">(</span>swiftMetricsInstance <span class=\"token punctuation\">:</span> sm<span class=\"token punctuation\">)</span></code></pre></div>\n<p>When you initialize a SwiftMetricsDash with just a SwiftMetrics instance, a Kitura server will be started that will serve the dashboard at localhost:8080/swiftmetrics-dash. If we only want to use a single interface, such as the dashboard, then this is fine. However if we add a second, for example a Prometheus endpoint, they will try to create servers on the same port and will conflict with each other.</p>\n<p>Next we will show you how to create and pass a Router object to the initializer, so that multiple types of monitoring can coexist.</p>\n<hr>\n<h2 id=\"step-3-using-application-metrics-for-swift-with-a-router\"><a href=\"#step-3-using-application-metrics-for-swift-with-a-router\" aria-label=\"step 3 using application metrics for swift with a router permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step 3: Using Application Metrics for Swift with a router</h2>\n<p>You can pass an existing Router instance to the SwiftMetricsDash initializer and it will use this router to serve the dashboard. If you don't have a Router, you can create one as follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">var</span> router <span class=\"token operator\">=</span> <span class=\"token function\">Router</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>SwiftMetricsDash will then add its dashboard's endpoint to the provided router:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">let</span> smd <span class=\"token operator\">=</span> <span class=\"token keyword\">try</span> <span class=\"token function\">SwiftMetricsDash</span><span class=\"token punctuation\">(</span>swiftMetricsInstance<span class=\"token punctuation\">:</span> sm<span class=\"token punctuation\">,</span> endpoint<span class=\"token punctuation\">:</span> router<span class=\"token punctuation\">)</span></code></pre></div>\n<p>You can add multiple monitoring interfaces to the same router and they will all be served together.</p>\n<p>You can now view our dashboard by starting the router on a Kitura server:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token builtin\">Kitura</span><span class=\"token punctuation\">.</span><span class=\"token function\">addHTTPServer</span><span class=\"token punctuation\">(</span>onPort<span class=\"token punctuation\">:</span> <span class=\"token number\">8080</span><span class=\"token punctuation\">,</span> with<span class=\"token punctuation\">:</span> router<span class=\"token punctuation\">)</span>\n<span class=\"token builtin\">Kitura</span><span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Once the server is running, go to localhost:8080/swiftmetrics-dash.</p>\n<hr>\n<h2 id=\"step-4-add-prometheus-support\"><a href=\"#step-4-add-prometheus-support\" aria-label=\"step 4 add prometheus support permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step 4: Add Prometheus support</h2>\n<p>To use Application Metrics for Swift to provide a Prometheus endpoint, you must include the SwiftMetricsPrometheus module in your application:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">import</span> <span class=\"token builtin\">SwiftMetrics</span>\n<span class=\"token keyword\">import</span> <span class=\"token builtin\">SwiftMetricsPrometheus</span></code></pre></div>\n<p>As above, we need to create an instance of SwiftMetrics:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">let</span> sm <span class=\"token operator\">=</span> <span class=\"token keyword\">try</span> <span class=\"token function\">SwiftMetrics</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Use this SwiftMetrics instance and your Router object to initialize Prometheus:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">let</span> smp <span class=\"token operator\">=</span> <span class=\"token keyword\">try</span> <span class=\"token function\">SwiftMetricsPrometheus</span><span class=\"token punctuation\">(</span>swiftMetricsInstance<span class=\"token punctuation\">:</span> sm<span class=\"token punctuation\">,</span> endpoint<span class=\"token punctuation\">:</span> router<span class=\"token punctuation\">)</span></code></pre></div>\n<p>By default, SwiftMetricsPrometheus will provide the Prometheus endpoint under localhost:8080/metrics.</p>\n<hr>\n<h2 id=\"step-5-add-rest-api-support\"><a href=\"#step-5-add-rest-api-support\" aria-label=\"step 5 add rest api support permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step 5: Add REST API support</h2>\n<p>The Application Metrics for Swift REST API enables the collection of metrics from the running Swift application. The API context root will be the server's default endpoint plus \"/swiftmetrics\" e.g. localhost:8080/swiftmetrics.</p>\n<p>To enable the REST API in your program, you must include the SwiftMetricsREST module in your application:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">import</span> <span class=\"token builtin\">SwiftMetrics</span>\n<span class=\"token keyword\">import</span> <span class=\"token builtin\">SwiftMetricsREST</span></code></pre></div>\n<p>As above, we need to create an instance of SwiftMetrics:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">let</span> sm <span class=\"token operator\">=</span> <span class=\"token keyword\">try</span> <span class=\"token function\">SwiftMetrics</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Use this SwiftMetrics instance and your Router object to initialize your REST API:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">let</span> smr <span class=\"token operator\">=</span> <span class=\"token keyword\">try</span> <span class=\"token function\">SwiftMetricsREST</span><span class=\"token punctuation\">(</span>swiftMetricsInstance<span class=\"token punctuation\">:</span> sm<span class=\"token punctuation\">,</span> endpoint<span class=\"token punctuation\">:</span> router<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Metrics are accumulated in a collection. The start time of the metrics accumulation is from either, creation of the collection POST &#x3C;context<em>root>/api/v1/collections, or, from the time of a clear request PUT &#x3C;context</em>root>/api/v1/collection/{id}.</p>\n<p>First you need to create a new metrics collection. Metrics are recorded from the point of the creation of the collection. To create a collection you can use curl as follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">curl -X POST http://localhost:8080/swiftmetrics/api/v1/collections</code></pre></div>\n<p>This will return the URI for your collection:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&quot;uri&quot; : &quot;collections\\/0&quot;</code></pre></div>\n<p>Metrics can now be retrieved from the collection at whatever intervals you choose using GET as follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">curl -X GET http://localhost:8080/swiftmetrics/api/v1/collections/0</code></pre></div>\n<p>Metrics are returned in JSON format for processing. You can use PUT to clear the metrics if required.</p>\n<p>Metrics can be deleted using DELETE as follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">curl -X DELETE http://localhost:8080/swiftmetrics/api/v1/collections/0</code></pre></div>\n<p>For more information about how to use the REST API and the available collection operations see the documentation.</p>","frontmatter":{"path":"/docs/deploying/monitoring","title":"Monitor the status of your Server"}},"docsList":{"nodes":[{"title":"Getting Started","items":[{"title":"Installation","link":"/docs/getting-started/installation"},{"title":"Hello World","link":"/docs/getting-started/hello-world"},{"title":"Create a Server","link":"/docs/getting-started/create-server"}]},{"title":"Logging","items":[{"title":"What is Logging?","link":"/docs/logging/what-is-logging"},{"title":"HeliumLogger","link":"/docs/logging/helium-logger"}]},{"title":"Routing","items":[{"title":"What is Routing?","link":"/docs/routing/what-is-routing"},{"title":"Codable Routing","link":"/docs/routing/codable-routing"},{"title":"OpenAPI","link":"/docs/routing/kitura-openapi"},{"title":"Raw Routing","link":"/docs/routing/raw-routing"}]},{"title":"Databases","items":[{"title":"What are Databases?","link":"/docs/databases/what-are-databases"},{"title":"SQL - ORM","link":"/docs/databases/orm"},{"title":"SQL - Kuery","link":"/docs/databases/kuery"},{"title":"NoSQL - CouchDB","link":"/docs/databases/couchdb"}]},{"title":"Sessions","items":[{"title":"What are Sessions?","link":"/docs/sessions/what-are-sessions"},{"title":"Codable Routing Session","link":"/docs/sessions/codable-session"},{"title":"Raw Routing Session","link":"/docs/sessions/raw-session"}]},{"title":"Authentication","items":[{"title":"What is Authentication?","link":"/docs/authentication/what-is-authentication"},{"title":"Basic Authentication","link":"/docs/authentication/basic-authentication"},{"title":"JSON Web Tokens","link":"/docs/authentication/jwt"},{"title":"OAuth 2.0 with Facebook/Google","link":"/docs/authentication/oauth2"}]},{"title":"Web Applications","items":[{"title":"What is Templating?","link":"/docs/web/what-is-templating"},{"title":"Static File Server","link":"/docs/web/static-file-server"},{"title":"Stencil","link":"/docs/web/stencil"},{"title":"Markdown","link":"/docs/web/markdown"}]},{"title":"Deploying","items":[{"title":"Monitoring","link":"/docs/deploying/monitoring"},{"title":"Enabling SSL/TLS","link":"/docs/deploying/enabling-ssl"},{"title":"Docker","link":"/docs/deploying/docker"},{"title":"Kubernetes","link":"/docs/deploying/kubernetes"},{"title":"Cloud Foundry","link":"/docs/deploying/cloud-foundry"}]}]}},"pageContext":{"isCreatedByStatefulCreatePages":false}}}